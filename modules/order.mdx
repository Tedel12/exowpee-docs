## Overview

The Order module is the core of the sales process in Exowpee. Its primary purpose is to manage the entire lifecycle of customer orders, from creation to completion. This module handles order creation, item management (what products were bought), status tracking, special actions (confirm, reject, complete, cancel), and cashing/payment status. It integrates with the catalog for product availability, customer module for client association, and ledger for accounting entries.

For complete beginners: Imagine a customer comes to your shop or places an order online. The Order module is where you record what they bought, how much they paid (or owe), and what happens next (approve, ship, complete). It tracks the "journey" of the order:  
- Pending → waiting for approval  
- Approved → confirmed  
- Shipped → sent to customer  
- Completed → delivered and paid  
- Rejected or canceled → stopped  

It also handles credit sales (customer pays later) and partial payments.

- **Key Objectives**:
  - Create orders quickly with customer and products from catalog.
  - Track order status through its full lifecycle.
  - Perform actions like confirm, reject, complete, or cancel.
  - Manage line items (products + quantities + prices).
  - Support credit sales and cashing reports.
  - Ensure stock updates (decrease stock on order creation/confirmation).
  - Integrate with accounting (ledger entries for sales).

- **How it Fits in Exowpee**:
  - **IAM**: Controls who can create/view/update orders (permissions like create_order, update_order).
  - **CATALOG**: Pulls products/variants/stock. Stock decreases when order is confirmed.
  - **CUSTOMER**: Links orders to customer_id for history and credit.
  - **LEDGER**: Generates sale entries (revenue) or credit entries.
  - Multi-tenant: Orders are scoped to your current company (from JWT token).

- **Why It's Important for Developers**:
  - Order IDs are Ksuid strings (27 characters, e.g., "39WSvi21oTnZN8i028Y80FTNT1x").
  - Line items reference variant_id from Catalog.
  - Status changes trigger events (e.g., stock update, ledger entry).
  - Beginners: Don't worry about Ksuid – generated automatically. Just use them in paths.


Common permissions for Order:
- `view_orders` : List and view order details.
- `create_order` : Create new orders.
- `update_order` : Change order details (items, note, status).
- `confirm_order` : Confirm pending orders.
- `reject_order` : Reject orders.
- `cancel_order` : Cancel orders.
- `complete_order` : Mark as completed.
- `view_cashing` : See cashing reports by status.

Example roles:
- **Admin** : All permissions (create, update, confirm, reject, complete, cancel).
- **Sales Manager** : view_orders, create_order, update_order, confirm_order.
- **Cashier** : view_orders, create_order (for quick sales).
- **Delivery Person** : update_order (mark shipped/completed).


## Endpoints

The Order module has 6 main routes (CRUD + custom actions). All are protected with Bearer JWT. Scoped to current company.

See [API Reference > Order](/api-reference/order) for technical details and API tests.

## Examples of Use

Let's go through each endpoint with full cURL examples, line-by-line explanations, response breakdown, and beginner tips.

### Example : List Orders (GET /v1/order)

This endpoint shows all orders in your current company. It's useful for seeing pending orders, completed sales, or daily activity.

**Required** : Nothing – just the token.

**Optional** :
- ?status=pending : Filter by status (pending, approved, shipped, completed).
- ?page=2 : Pagination.
- ?limit=20 : Items per page.

cURL example (basic):
```bash
curl -X GET "http://localhost:8000/v1/order" \
  -H "Authorization: Bearer <your_token>"
```

cURL example with filter:
```bash
curl -X GET "http://localhost:8000/v1/order?status=pending" \
  -H "Authorization: Bearer <your_token>"
```

**Expected Response (200 OK)** :
```json
{
  "data": [
    {
      "id": "39WSvi21oTnZN8i028Y80FTNT1x",
      "customer_id": "39XabcdeFgHijKlMnOpQrStUvWx",
      "total": 185000,
      "tax_total": 0,
      "discount": 0,
      "charge": 0,
      "is_credit": false,
      "status": "pending",
      "note": "Urgent delivery",
      "company_id": "39WSvi21oTnZN8i028Y80FTNT1x",
      "created_at": "2026-02-12T16:45:00Z",
      "updated_at": "2026-02-12T16:45:00Z"
    }
  ],
  "meta": {
    "current_page": 1,
    "last_page": 1,
    "per_page": 15,
    "total": 1
  }
}
```

**Explanation of Response Properties** :
- **data** : Array of order objects. Each order has:
  - **id** : Unique Ksuid for the order.
  - **customer_id** : Ksuid of the linked customer (from Customer module).
  - **total** : Final amount (sum of items + tax - discount + charge).
  - **tax_total** : Tax amount.
  - **discount** : Discount applied.
  - **charge** : Extra charges (e.g., delivery fee).
  - **is_credit** : True if customer pays later.
  - **status** : Current status (pending, approved, shipped, completed, rejected, canceled).
  - **note** : Optional note from seller.
  - **company_id** : Company this order belongs to.
  - **created_at** / **updated_at** : Timestamps.
- **meta** : Pagination info (current_page, last_page, per_page, total).

**What This Does** : Fetches orders from the database, scoped to your company, applies filters/pagination, and returns them.


**Advanced Notes** : Supports sorting (?sort=total:desc) and filtering (?customer_id=Ksuid).

**Link to API Reference** : See [API Reference > Order](/api-reference) for technical details.

## Was this page helpful?

Your feedback helps us improve the documentation.

<div style={{ display: 'flex', gap: '16px', marginTop: '16px' }}>
  <button
    onClick={() => {
      document.getElementById('feedback-yes-message').style.display = 'block';
      document.getElementById('feedback-no-message').style.display = 'none';
      setTimeout(() => {
        document.getElementById('feedback-yes-message').style.display = 'none';
      }, 4000);
    }}
    style={{
      padding: '10px 24px',
      color: '#16A34A',
      border: 'none',
      borderRadius: '8px',
      cursor: 'pointer',
      fontWeight: '600',
      fontSize: '15px',
    }}
  >
    Yes
  </button>

  <button
    onClick={() => {
      document.getElementById('feedback-no-message').style.display = 'block';
      document.getElementById('feedback-yes-message').style.display = 'none';
      setTimeout(() => {
        document.getElementById('feedback-no-message').style.display = 'none';
      }, 4000);
    }}
    style={{
      padding: '10px 24px',
      color: '#e53e3e',
      border: 'none',
      borderRadius: '8px',
      cursor: 'pointer',
      fontWeight: '600',
      fontSize: '15px',
    }}
  >
    No
  </button>
</div>

{/* Message Yes */}
<div 
  id="feedback-yes-message" 
  style={{ 
    display: 'none', 
    marginTop: '20px', 
    padding: '12px 20px', 
    backgroundColor: '#000702d6', 
    borderRadius: '8px', 
    border: 'none', 
    color: '#16A34A', 
    fontSize: '15px', 
    fontWeight: '500',
    textAlign: 'center'
  }}
>
  Thank you! We're glad this helped
</div>

{/* Message No */}
<div 
  id="feedback-no-message" 
  style={{ 
    display: 'none', 
    marginTop: '20px', 
    padding: '12px 20px', 
    backgroundColor: '#130101', 
    borderRadius: '8px', 
    border: 'none', 
    color: '#991b1b', 
    fontSize: '15px', 
    fontWeight: '500',
    textAlign: 'center'
  }}
>
  Thanks for the feedback — we'll improve it!
</div>
```