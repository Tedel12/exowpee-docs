## Overview

The TEAM module manages companies, branches, teams, and multi-tenant organization in Exowpee. Its primary purpose is to support businesses that operate multiple companies, branches, or teams, while maintaining strict data isolation (multi-tenancy). It allows creating a main company, adding child branches (subsidiaries, stores, departments), managing hierarchical structure, and resolving the "current company context" for each user session.

For complete beginners: Imagine you own several shops or businesses (e.g., one in Cotonou, one in Porto-Novo, and a wholesale branch). The TEAM module lets you:
- Create your main company
- Add branches/stores as "children"
- Assign users to specific companies or branches
- Make sure that when a user logs in, they only see data from their current company (no mixing between shops)
- Upload logos per company
- Handle hierarchical organization (parent company → child branches)

This is what makes Exowpee "multi-company ready". Every other module (Catalog, Orders, Customers, Ledger) automatically works only on data from the user's current company.

- **Key Objectives**:
  - Create and manage companies and their hierarchical structure (main + children/branches).
  - Assign users to companies and resolve their current context (which company they are working in).
  - Support branding per company (logos, names, settings).
  - Ensure strict data isolation (multi-tenancy) – no company can see another's data.
  - Provide flexibility for small businesses (one company) and large groups (many branches).

For beginners: When you log in, the system automatically sets your "current company" based on your profile. All your actions (creating products, orders, etc.) happen only in that company. If you need to switch to another company (e.g., from main shop to branch), you change your active profile (via IAM). This prevents mistakes like selling stock from the wrong shop.

- **How it Fits in Exowpee**:
  - **IAM**: Links users to companies via profiles. Permissions and context are per company.
  - **CATALOG / ORDER / CUSTOMER / LEDGER**: All data is filtered by company_id from the user's current context.
  - Multi-tenant everywhere: Every table has a company_id column – enforced automatically.
  - Logo management: Each company can have its own logo (uploaded via POST /company/set/logo).



Common permissions for TEAM:
- `view_companies` : List companies and branches.
- `create_company` : Create new main companies or branches.
- `update_company` : Edit company details (name, phone, address, logo).
- `manage_branches` : Create/update/delete child branches.
- `manage_company_settings` : Change company-specific settings (tax, currency, etc.).

Example roles:
- **Super Admin** : All permissions (create, update, delete companies/branches).
- **Company Admin** : view_companies, create_company (branches), update_company, manage_branches (for their main company).
- **Branch Manager** : view_companies (their branch only), limited update.
- **Regular User** : No TEAM permissions – they just work in their assigned company.


## Endpoints

The TEAM module has a few key routes for managing companies and branches. All are protected with Bearer JWT. Scoped to current user permissions.

**Link to API Reference** : See [API Reference > Company](/api-reference) for technical details.

## Examples of Use

Let's walk through each endpoint step by step with full cURL examples, explanations, and beginner tips.

### Example : List Companies (GET /v1/company)

This endpoint shows all companies and branches you have access to (usually your main company + its children).

**Required** : Nothing – just the token.

**Optional** :
- ?is_main=true : Show only main companies.

cURL example:
```bash
curl -X GET "http://localhost:8000/v1/company" \
  -H "Authorization: Bearer <your_token>"
```

**Expected Response (200 OK)** :
```json
{
  "data": [
    {
      "id": "39WSvi21oTnZN8i028Y80FTNT1x",
      "name": "Exowpee Main",
      "tax_registration_number": "1234567890",
      "business_registration_number": "RCCM BJ ABC123",
      "address": "Cotonou, Littoral, Benin",
      "phone_number": "+22912345678",
      "is_main": true,
      "parent": null,
      "uuid": "some-uuid",
      "is_active": true,
      "logo": {
        "url": "https://storage.exowpee.com/logos/main.png"
      },
      "subscription_on": "2026-01-01T00:00:00Z",
      "trial_end": null,
      "next_billing": "2026-03-01T00:00:00Z",
      "children_count": 2,
      "enable_mecef": true,
      "enable_ecom": false,
      "enable_label_generator": true
    },
    {
      "id": "39XabcdeFgHijKlMnOpQrStUvWx",
      "name": "Cotonou Branch",
      "is_main": false,
      "parent": { "id": "39WSvi21oTnZN8i028Y80FTNT1x" },
      "children_count": 0
    }
  ],
  "meta": {
    "total": 2
  }
}
```

**Explanation of Response Properties** :
- **data** : Array of company objects. Each company has:
  - **id** : Unique Ksuid.
  - **name** : Company or branch name.
  - **tax_registration_number** / **business_registration_number** : Official registration numbers (for tax/invoicing).
  - **address** / **phone_number** : Contact info.
  - **is_main** : true for the parent company, false for branches.
  - **parent** : If it's a branch, reference to parent company.
  - **logo** : URL to the company logo.
  - **children_count** : Number of branches under this company.
  - **enable_mecef** / **enable_ecom** / **enable_label_generator** : Feature flags per company.
- **meta** : Total count.

**What This Does** : Fetches companies based on your permissions and current context.


**Advanced Notes** : Supports hierarchical queries (parent/children).

**Common error** : 400 – invalid file type/size.

See [API Reference > Company](/api-reference) for technical details and API tests.

## Was this page helpful?

Your feedback helps us improve the documentation.

<div style={{ display: 'flex', gap: '16px', marginTop: '16px' }}>
  <button
    onClick={() => {
      document.getElementById('feedback-yes-message').style.display = 'block';
      document.getElementById('feedback-no-message').style.display = 'none';
      setTimeout(() => {
        document.getElementById('feedback-yes-message').style.display = 'none';
      }, 4000);
    }}
    style={{
      padding: '10px 24px',
      color: '#16A34A',
      border: 'none',
      borderRadius: '8px',
      cursor: 'pointer',
      fontWeight: '600',
      fontSize: '15px',
    }}
  >
    Yes
  </button>

  <button
    onClick={() => {
      document.getElementById('feedback-no-message').style.display = 'block';
      document.getElementById('feedback-yes-message').style.display = 'none';
      setTimeout(() => {
        document.getElementById('feedback-no-message').style.display = 'none';
      }, 4000);
    }}
    style={{
      padding: '10px 24px',
      color: '#e53e3e',
      border: 'none',
      borderRadius: '8px',
      cursor: 'pointer',
      fontWeight: '600',
      fontSize: '15px',
    }}
  >
    No
  </button>
</div>

{/* Message Yes */}
<div 
  id="feedback-yes-message" 
  style={{ 
    display: 'none', 
    marginTop: '20px', 
    padding: '12px 20px', 
    backgroundColor: '#000702d6', 
    borderRadius: '8px', 
    border: 'none', 
    color: '#16A34A', 
    fontSize: '15px', 
    fontWeight: '500',
    textAlign: 'center'
  }}
>
  Thank you! We're glad this helped
</div>

{/* Message No */}
<div 
  id="feedback-no-message" 
  style={{ 
    display: 'none', 
    marginTop: '20px', 
    padding: '12px 20px', 
    backgroundColor: '#130101', 
    borderRadius: '8px', 
    border: 'none', 
    color: '#991b1b', 
    fontSize: '15px', 
    fontWeight: '500',
    textAlign: 'center'
  }}
>
  Thanks for the feedback — we'll improve it!
</div>
```